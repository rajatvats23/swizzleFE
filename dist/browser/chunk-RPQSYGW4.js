import{a as ut}from"./chunk-CKPTGNVJ.js";import{a as dt}from"./chunk-MRIKSRXR.js";import{a as ct}from"./chunk-7NFB522G.js";import{c as lt}from"./chunk-EFAJY4UT.js";import{b as at}from"./chunk-L2OVOT2R.js";import{b as st,g as mt}from"./chunk-54ULQ5WC.js";import{d as nt,h as rt,i as ot}from"./chunk-PXLRJANG.js";import"./chunk-H5SIC52C.js";import"./chunk-3Z3MOL6J.js";import{a as D,b as F,c as k,f as V,h as N}from"./chunk-QTDDUBQI.js";import{a as tt,b as et}from"./chunk-SWI6467K.js";import{a as K,c as W,d as X}from"./chunk-2D2I2PDG.js";import{b as $,c as z,i as J}from"./chunk-PTRNPYW6.js";import{a as it}from"./chunk-URY737FD.js";import{b as R,d as p,g as L,h as P,m as B,n as A,p as G,s as Q,t as j,u as U,w as q,y as H}from"./chunk-NZ7PJTNX.js";import"./chunk-75BXHIVP.js";import{a as w}from"./chunk-5XSEBNVB.js";import"./chunk-4MJ6IACY.js";import{q as Y,u as Z}from"./chunk-FE5XWYP3.js";import"./chunk-GTI6TFUP.js";import{a as E,c as I,d as O}from"./chunk-VSTSZJ55.js";import{Cc as M,Db as v,Fb as x,Gb as d,Kc as T,Rb as e,Sb as u,Ta as l,Tb as _,Ub as S,ac as y,cb as h,hb as g,ja as c,ob as s,qa as b,ra as f,xb as i,yb as t,zb as C}from"./chunk-KAD4X6AH.js";var bt=o=>["/tables/edit",o];function ft(o,r){if(o&1&&(i(0,"button",29)(1,"mat-icon",7),e(2,"edit"),t(),e(3," Edit "),t()),o&2){let n=d(2);s("routerLink",y(1,bt,n.table._id))}}function gt(o,r){if(o&1){let n=v();i(0,"button",30),x("click",function(){b(n);let a=d(2);return f(a.confirmDelete())}),i(1,"mat-icon",7),e(2,"delete"),t(),e(3," Delete "),t()}}function xt(o,r){o&1&&(i(0,"mat-error"),e(1,"Occupancy cannot be negative"),t())}function vt(o,r){o&1&&(i(0,"mat-error"),e(1,"Occupancy cannot exceed capacity"),t())}function _t(o,r){if(o&1){let n=v();i(0,"div",2)(1,"div",3)(2,"span",4),e(3),t(),i(4,"div",5)(5,"button",6)(6,"mat-icon",7),e(7,"arrow_back"),t(),e(8," Back to List "),t(),i(9,"button",8),x("click",function(){b(n);let a=d();return f(a.showQRCode())}),i(10,"mat-icon",7),e(11,"qr_code"),t(),e(12," QR Code "),t(),g(13,ft,4,3,"button",9)(14,gt,4,0,"button",10),t()(),i(15,"div",11)(16,"mat-card")(17,"mat-card-header")(18,"mat-card-title"),e(19,"Table Details"),t()(),i(20,"mat-card-content")(21,"div",12)(22,"div",13)(23,"span",14),e(24,"Table Number:"),t(),i(25,"span"),e(26),t()(),i(27,"div",13)(28,"span",14),e(29,"Capacity:"),t(),i(30,"span"),e(31),t()(),i(32,"div",13)(33,"span",14),e(34,"Status:"),t(),i(35,"mat-chip",15),e(36),t()(),i(37,"div",13)(38,"span",14),e(39,"Current Occupancy:"),t(),i(40,"span"),e(41),t()(),i(42,"div",13)(43,"span",14),e(44,"QR Code Identifier:"),t(),i(45,"span"),e(46),t()()()()(),i(47,"mat-card")(48,"mat-card-header")(49,"mat-card-title",16),e(50,"Update Status"),t()(),i(51,"mat-card-content")(52,"form",17),x("ngSubmit",function(){b(n);let a=d();return f(a.updateStatus())}),i(53,"mat-form-field",18)(54,"mat-label"),e(55,"Status"),t(),i(56,"mat-select",19)(57,"mat-option",20),e(58,"Available"),t(),i(59,"mat-option",21),e(60,"Reserved"),t(),i(61,"mat-option",22),e(62,"Occupied"),t(),i(63,"mat-option",23),e(64,"Cleaning"),t(),i(65,"mat-option",24),e(66,"Out of Service"),t()()(),i(67,"mat-form-field",18)(68,"mat-label"),e(69,"Current Occupancy"),t(),C(70,"input",25),g(71,xt,2,0,"mat-error",26)(72,vt,2,0,"mat-error",26),t(),i(73,"div",27)(74,"button",28),e(75),t()()()()()()()}if(o&2){let n,m,a=d();l(3),_("Table ",a.table.tableNumber,""),l(10),s("ngIf",a.isManager()),l(),s("ngIf",a.isManager()),l(12),u(a.table.tableNumber),l(5),u(a.table.capacity),l(4),s("color",a.getStatusColor(a.table.status)),l(),u(a.table.status),l(5),S("",a.table.currentOccupancy," / ",a.table.capacity,""),l(5),u(a.table.qrCodeIdentifier),l(6),s("formGroup",a.statusForm),l(18),s("max",a.table.capacity),l(),s("ngIf",(n=a.statusForm.get("currentOccupancy"))==null?null:n.hasError("min")),l(),s("ngIf",(m=a.statusForm.get("currentOccupancy"))==null?null:m.hasError("max")),l(2),s("disabled",a.statusForm.invalid||a.isSubmitting),l(),_(" ",a.isSubmitting?"Updating...":"Update Status"," ")}}function ht(o,r){o&1&&(i(0,"div",31)(1,"p"),e(2,"Loading table details..."),t()())}var pt=class o{route=c(E);router=c(I);tableService=c(dt);authService=c(w);fb=c(q);snackBar=c(it);dialog=c(lt);table=null;isLoading=!0;isSubmitting=!1;tableId="";statusForm;ngOnInit(){this.initForm(),this.tableId=this.route.snapshot.params.id,this.tableId?this.loadTable():this.router.navigate(["/tables"])}initForm(){this.statusForm=this.fb.group({status:["",p.required],currentOccupancy:[0,[p.min(0)]]})}loadTable(){this.isLoading=!0,this.tableService.getTableById(this.tableId).subscribe({next:r=>{this.table=r.data.table,this.statusForm.patchValue({status:this.table.status,currentOccupancy:this.table.currentOccupancy}),this.statusForm.get("currentOccupancy")?.setValidators([p.min(0),p.max(this.table.capacity)]),this.statusForm.get("currentOccupancy")?.updateValueAndValidity(),this.isLoading=!1},error:r=>{this.snackBar.open(r.error?.message||"Failed to load table","Close",{duration:5e3}),this.isLoading=!1,this.router.navigate(["/tables"])}})}updateStatus(){if(this.statusForm.invalid||!this.table)return;this.isSubmitting=!0;let r=this.statusForm.value;this.tableService.updateTableStatus(this.tableId,r).subscribe({next:n=>{this.table=n.data.table,this.snackBar.open("Table status updated successfully","Close",{duration:3e3}),this.isSubmitting=!1},error:n=>{this.isSubmitting=!1,this.snackBar.open(n.error?.message||"Failed to update table status","Close",{duration:5e3})}})}isManager(){return this.authService.getCurrentUser()?.role==="manager"}getStatusColor(r){switch(r){case"Available":return"primary";case"Reserved":return"accent";case"Occupied":return"warn";case"Cleaning":return"";case"Out of Service":return"";default:return""}}showQRCode(){this.table&&this.dialog.open(ut,{data:{table:this.table},width:"400px"})}confirmDelete(){if(!this.table)return;this.dialog.open(ct,{data:{title:"Delete Table",message:`Are you sure you want to delete table "${this.table.tableNumber}"?`,confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(n=>{n&&this.deleteTable()})}deleteTable(){this.table&&this.tableService.deleteTable(this.tableId).subscribe({next:()=>{this.snackBar.open("Table deleted successfully","Close",{duration:3e3}),this.router.navigate(["/tables"])},error:r=>{this.snackBar.open(r.error?.message||"Error deleting table","Close",{duration:5e3})}})}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=h({type:o,selectors:[["app-table-detail"]],decls:2,vars:2,consts:[["class","container",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"container"],[1,"header-actions"],[1,"top-label"],[1,"action-buttons"],["mat-button","","color","primary","routerLink","/tables"],[1,"material-symbols-outlined"],["mat-raised-button","","color","primary","matTooltip","Show QR Code",3,"click"],["mat-raised-button","","color","accent",3,"routerLink",4,"ngIf"],["mat-raised-button","","color","warn",3,"click",4,"ngIf"],[1,"detail-grid"],[1,"table-info"],[1,"info-row"],[1,"label"],["selected","",3,"color"],[1,"mb-3"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["formControlName","status"],["value","Available"],["value","Reserved"],["value","Occupied"],["value","Cleaning"],["value","Out of Service"],["matInput","","formControlName","currentOccupancy","type","number","min","0",3,"max"],[4,"ngIf"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-raised-button","","color","accent",3,"routerLink"],["mat-raised-button","","color","warn",3,"click"],[1,"loading-container"]],template:function(n,m){n&1&&g(0,_t,76,16,"div",0)(1,ht,3,0,"div",1),n&2&&(s("ngIf",m.table),l(),s("ngIf",m.isLoading))},dependencies:[T,M,H,B,R,A,L,P,U,j,G,Q,O,N,D,k,V,F,Z,Y,et,tt,mt,st,at,K,J,$,z,X,W,ot,rt,nt],styles:[".container[_ngcontent-%COMP%]{width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:10px}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:20px}.table-info[_ngcontent-%COMP%]{padding:16px 0}.info-row[_ngcontent-%COMP%]{margin-bottom:16px;display:flex;align-items:center}.label[_ngcontent-%COMP%]{font-weight:500;width:150px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px}@media (max-width: 767px){.header-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.action-buttons[_ngcontent-%COMP%]{margin-top:10px;flex-wrap:wrap}}"]})};export{pt as TableDetailComponent};
