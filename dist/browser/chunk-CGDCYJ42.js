import{a as de}from"./chunk-KEIRLDTM.js";import{a as re,b as ae}from"./chunk-2UETUZ57.js";import"./chunk-2OJIEFOL.js";import{i as ie}from"./chunk-PXLRJANG.js";import"./chunk-H5SIC52C.js";import"./chunk-3Z3MOL6J.js";import{a as O,c as N,h as P}from"./chunk-QTDDUBQI.js";import{a as te,b as ne}from"./chunk-SWI6467K.js";import{a as K,c as Q,d as W}from"./chunk-2D2I2PDG.js";import{b as z,c as U,f as H,i as J}from"./chunk-PTRNPYW6.js";import{a as oe}from"./chunk-URY737FD.js";import{b as k,d as c,g as w,h as B,m as T,n as G,p as q,q as V,r as D,s as L,u as R,w as j,y as $}from"./chunk-NZ7PJTNX.js";import"./chunk-75BXHIVP.js";import"./chunk-4MJ6IACY.js";import{n as X,q as Y,t as Z,u as ee}from"./chunk-FE5XWYP3.js";import"./chunk-GTI6TFUP.js";import{a as y,c as E,d as I}from"./chunk-VSTSZJ55.js";import{Bc as C,Cc as x,Db as M,Fb as b,Gb as S,Kc as F,Rb as o,Sb as A,Ta as d,Tb as g,cb as v,hb as u,ja as p,ob as m,qa as _,ra as h,xb as n,yb as t,zb as f}from"./chunk-KAD4X6AH.js";function se(a,e){a&1&&(n(0,"mat-error"),o(1,"Name is required"),t())}function pe(a,e){a&1&&(n(0,"mat-error"),o(1,"Name is required"),t())}function ue(a,e){a&1&&(n(0,"mat-error"),o(1,"Price is required"),t())}function ce(a,e){a&1&&(n(0,"mat-error"),o(1,"Price cannot be negative"),t())}function fe(a,e){if(a&1){let i=M();n(0,"div",21)(1,"mat-form-field",22)(2,"mat-label"),o(3,"Option Name"),t(),f(4,"input",23),u(5,pe,2,0,"mat-error",8),t(),n(6,"mat-form-field",22)(7,"mat-label"),o(8,"Price"),t(),f(9,"input",24),n(10,"span",25),o(11,"$"),t(),u(12,ue,2,0,"mat-error",8)(13,ce,2,0,"mat-error",8),t(),n(14,"button",26),b("click",function(){let l=_(i).index,s=S();return h(s.removeSubAddon(l))}),n(15,"mat-icon",4),o(16,"delete"),t()()()}if(a&2){let i,r,l,s=e.$implicit,le=e.index;m("formGroupName",le),d(5),m("ngIf",(i=s.get("name"))==null?null:i.hasError("required")),d(7),m("ngIf",(r=s.get("price"))==null?null:r.hasError("required")),d(),m("ngIf",(l=s.get("price"))==null?null:l.hasError("min"))}}function be(a,e){a&1&&(n(0,"div",27)(1,"p"),o(2,"No options added. Click the + button to add options."),t()())}var me=class a{fb=p(j);route=p(y);router=p(E);addonService=p(de);snackBar=p(oe);addonForm;isEditMode=!1;isSubmitting=!1;addonId="";get subAddonsArray(){return this.addonForm.get("subAddons")}ngOnInit(){this.initForm(),this.addonId=this.route.snapshot.params.id,this.isEditMode=!!this.addonId,this.isEditMode&&this.loadAddonData()}initForm(){this.addonForm=this.fb.group({name:["",c.required],isMultiSelect:[!1],subAddons:this.fb.array([])})}createSubAddonForm(e){return this.fb.group({_id:[e?._id||""],name:[e?.name||"",c.required],price:[e?.price||0,[c.required,c.min(0)]]})}addSubAddon(e){this.subAddonsArray.push(this.createSubAddonForm(e))}removeSubAddon(e){this.subAddonsArray.removeAt(e)}loadAddonData(){this.addonService.getAddonById(this.addonId).subscribe({next:e=>{let i=e.data.addon;this.addonForm.patchValue({name:i.name,isMultiSelect:i.isMultiSelect}),this.subAddonsArray.clear(),i.subAddons&&i.subAddons.length&&i.subAddons.forEach(r=>{this.addSubAddon(r)})},error:e=>{this.snackBar.open(e.error?.message||"Failed to load addon","Close",{duration:5e3}),this.router.navigate(["/dashboard/addons"])}})}onSubmit(){if(this.addonForm.invalid)return;this.isSubmitting=!0;let e=this.addonForm.value;this.isEditMode?this.addonService.updateAddon(this.addonId,e).subscribe({next:()=>{this.snackBar.open("Addon updated successfully","Close",{duration:3e3}),this.router.navigate(["/dashboard/addons"])},error:i=>{this.isSubmitting=!1,this.snackBar.open(i.error?.message||"Failed to update addon","Close",{duration:5e3})}}):this.addonService.createAddon(e).subscribe({next:()=>{this.snackBar.open("Addon created successfully","Close",{duration:3e3}),this.router.navigate(["/dashboard/addons"])},error:i=>{this.isSubmitting=!1,this.snackBar.open(i.error?.message||"Failed to create addon","Close",{duration:5e3})}})}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=v({type:a,selectors:[["app-addon-form"]],decls:36,vars:8,consts:[[1,"container"],[1,"header-actions"],[1,"top-label"],["mat-button","","color","primary","routerLink","/dashboard/addons"],[1,"material-symbols-outlined"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Enter addon name"],[4,"ngIf"],[1,"form-row","toggle-row"],["formControlName","isMultiSelect","color","primary"],[1,"toggle-hint"],[1,"sub-addons-container"],[1,"sub-addons-header"],["mat-mini-fab","","color","primary","type","button","aria-label","Add option",3,"click"],["formArrayName","subAddons",1,"sub-addons-list"],["class","sub-addon-item",3,"formGroupName",4,"ngFor","ngForOf"],["class","no-options",4,"ngIf"],[1,"form-actions"],["mat-button","","type","button","routerLink","/dashboard/addons"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"sub-addon-item",3,"formGroupName"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Enter option name"],["matInput","","formControlName","price","type","number","min","0","step","0.01","placeholder","Enter price"],["matTextSuffix",""],["mat-icon-button","","color","warn","type","button","aria-label","Remove option",3,"click"],[1,"no-options"]],template:function(i,r){if(i&1&&(n(0,"div",0)(1,"div",1)(2,"span",2),o(3),t(),n(4,"button",3)(5,"mat-icon",4),o(6,"arrow_back"),t(),o(7," Back to List "),t()(),n(8,"mat-card")(9,"mat-card-content")(10,"form",5),b("ngSubmit",function(){return r.onSubmit()}),n(11,"mat-form-field",6)(12,"mat-label"),o(13,"Addon Name"),t(),f(14,"input",7),u(15,se,2,0,"mat-error",8),t(),n(16,"div",9)(17,"mat-slide-toggle",10),o(18," Allow Multiple Selections "),t(),n(19,"span",11),o(20),t()(),n(21,"div",12)(22,"div",13)(23,"h3"),o(24,"Options"),t(),n(25,"button",14),b("click",function(){return r.addSubAddon()}),n(26,"mat-icon",4),o(27,"add"),t()()(),n(28,"div",15),u(29,fe,17,4,"div",16)(30,be,3,0,"div",17),t()(),n(31,"div",18)(32,"button",19),o(33,"Cancel"),t(),n(34,"button",20),o(35),t()()()()()()),i&2){let l,s;d(3),g("",r.isEditMode?"Edit":"Create"," Addon"),d(7),m("formGroup",r.addonForm),d(5),m("ngIf",(l=r.addonForm.get("name"))==null?null:l.hasError("required")),d(5),A((s=r.addonForm.get("isMultiSelect"))!=null&&s.value?"Customers can select multiple options":"Customers can select only one option"),d(9),m("ngForOf",r.subAddonsArray.controls),d(),m("ngIf",r.subAddonsArray.length===0),d(4),m("disabled",r.addonForm.invalid||r.isSubmitting),d(),g(" ",r.isSubmitting?"Saving...":r.isEditMode?"Update":"Create"," ")}},dependencies:[F,C,x,$,T,k,G,w,B,R,q,L,V,D,I,K,J,z,U,H,W,Q,ee,Y,X,Z,P,O,N,ne,te,ie,ae,re],styles:[".container[_ngcontent-%COMP%]{width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.form-row[_ngcontent-%COMP%]{margin-bottom:16px}.toggle-row[_ngcontent-%COMP%]{display:flex;align-items:center}.toggle-hint[_ngcontent-%COMP%]{margin-left:12px;font-size:12px;color:#666}.sub-addons-container[_ngcontent-%COMP%]{margin-top:24px;margin-bottom:24px}.sub-addons-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.sub-addons-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0}.sub-addons-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.sub-addon-item[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.sub-addon-item[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:first-child{flex:2}.sub-addon-item[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:nth-child(2){flex:1}.no-options[_ngcontent-%COMP%]{padding:16px;background-color:#f5f5f5;border-radius:4px;text-align:center}.form-actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end;margin-top:20px}"]})};export{me as AddonFormComponent};
