import{a as pt}from"./chunk-DDYOQQB5.js";import{a as gt}from"./chunk-AFSGQ5UB.js";import{c as dt,h as ct}from"./chunk-IEN5B5W2.js";import{a as Y,b as Z,c as tt,d as et,e as it,f as at,g as nt,h as ot,i as rt,j as lt,k as mt,l as st}from"./chunk-66KDBNKL.js";import"./chunk-4NNSIX2F.js";import{a as y,b as D,c as I,f as L,h as k}from"./chunk-X4H6S6WA.js";import{a as Q,b as W}from"./chunk-FNZWV5VH.js";import{a as q,c as U,d as G}from"./chunk-SG7MWKE6.js";import{b as A,c as $,i as j}from"./chunk-TFWZGPIA.js";import{a as X}from"./chunk-MXW2SQ2E.js";import{b as N,d as F,g as R,h as V,k as B,m as O,o as P,z as H}from"./chunk-CG6HKZKU.js";import"./chunk-YE4XPGXQ.js";import{a as E}from"./chunk-DAAD4K4P.js";import"./chunk-4MJ6IACY.js";import{n as z,q as J,u as K}from"./chunk-QRFS6CQK.js";import"./chunk-24M76UXH.js";import{Ab as h,Bb as b,Cc as v,Db as _,Fb as p,Gb as d,Kc as w,Rb as r,Sb as M,Ta as l,Tb as S,cb as x,hb as s,ja as g,ob as m,qa as u,ra as f,xb as a,yb as o,zb as C}from"./chunk-Q5RHU532.js";function ft(e,t){e&1&&(a(0,"mat-error"),r(1,"Tag name is required"),o())}function Ct(e,t){if(e&1){let i=_();a(0,"button",20),p("click",function(){u(i);let c=d();return f(c.cancelEdit())}),r(1,"Cancel"),o()}}function _t(e,t){e&1&&(a(0,"th",21),r(1,"Name"),o())}function Tt(e,t){if(e&1&&(a(0,"td",22),r(1),o()),e&2){let i=t.$implicit;l(),M(i.name)}}function ht(e,t){e&1&&(a(0,"th",21),r(1,"Actions"),o())}function bt(e,t){if(e&1){let i=_();a(0,"button",25),p("click",function(){u(i);let c=d().$implicit,T=d();return f(T.editTag(c))}),a(1,"mat-icon",26),r(2,"edit"),o()()}}function Mt(e,t){if(e&1){let i=_();a(0,"button",27),p("click",function(){u(i);let c=d().$implicit,T=d();return f(T.confirmDelete(c))}),a(1,"mat-icon",26),r(2,"delete"),o()()}}function xt(e,t){if(e&1&&(a(0,"td",22),s(1,bt,3,0,"button",23)(2,Mt,3,0,"button",24),o()),e&2){let i=d();l(),m("ngIf",i.canManageTags()),l(),m("ngIf",i.canManageTags())}}function St(e,t){e&1&&C(0,"tr",28)}function vt(e,t){e&1&&C(0,"tr",29)}function wt(e,t){e&1&&(a(0,"tr",30)(1,"td",31),r(2," No tags found "),o()())}var ut=class e{tagService=g(pt);authService=g(E);snackBar=g(X);dialog=g(dt);tags=[];displayedColumns=["name","actions"];isLoading=!1;isSubmitting=!1;isEditMode=!1;editTagId="";tagNameControl=new B("",[F.required]);ngOnInit(){this.loadTags()}loadTags(){this.isLoading=!0,this.tagService.getTags().subscribe({next:t=>{this.tags=t.data.tags,this.isLoading=!1},error:t=>{console.error("Error loading tags:",t),this.snackBar.open(t.error?.message||"Failed to load tags","Close",{duration:5e3}),this.isLoading=!1}})}onSubmit(){if(this.tagNameControl.invalid)return;this.isSubmitting=!0;let t=this.tagNameControl.value||"";this.isEditMode?this.tagService.updateTag(this.editTagId,{name:t}).subscribe({next:()=>{this.snackBar.open("Tag updated successfully","Close",{duration:3e3}),this.resetForm(),this.loadTags()},error:i=>{this.isSubmitting=!1,this.snackBar.open(i.error?.message||"Failed to update tag","Close",{duration:5e3})}}):this.tagService.createTag({name:t}).subscribe({next:()=>{this.snackBar.open("Tag created successfully","Close",{duration:3e3}),this.resetForm(),this.loadTags()},error:i=>{this.isSubmitting=!1,this.snackBar.open(i.error?.message||"Failed to create tag","Close",{duration:5e3})}})}editTag(t){this.isEditMode=!0,this.editTagId=t._id,this.tagNameControl.setValue(t.name)}cancelEdit(){this.resetForm()}resetForm(){this.isEditMode=!1,this.editTagId="",this.tagNameControl.reset(),this.isSubmitting=!1}confirmDelete(t){this.dialog.open(gt,{data:{title:"Delete Tag",message:`Are you sure you want to delete the tag "${t.name}"?`,confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(n=>{n&&this.deleteTag(t._id)})}deleteTag(t){this.tagService.deleteTag(t).subscribe({next:()=>{this.snackBar.open("Tag deleted successfully","Close",{duration:3e3}),this.loadTags()},error:i=>{this.snackBar.open(i.error?.message||"Error deleting tag","Close",{duration:5e3})}})}canManageTags(){return this.authService.getCurrentUser()?.role==="manager"}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=x({type:e,selectors:[["app-tag-list"]],decls:35,vars:9,consts:[[1,"tag-container"],[1,"header-actions"],[1,"header-title"],[1,"tag-grid"],[1,"tag-form-card"],[3,"ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Enter tag name",3,"formControl"],[4,"ngIf"],[1,"form-actions"],["mat-button","","type","button",3,"click",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-table","",1,"tag-table",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-button","","type","button",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","accent","matTooltip","Edit",3,"click",4,"ngIf"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","Edit",3,"click"],[1,"material-symbols-outlined"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","2",1,"mat-cell",2,"text-align","center","padding","16px"]],template:function(i,n){i&1&&(a(0,"div",0)(1,"div",1)(2,"span",2),r(3,"Tag Management"),o()(),a(4,"div",3)(5,"mat-card",4)(6,"mat-card-header")(7,"mat-card-title"),r(8),o()(),a(9,"mat-card-content")(10,"form",5),p("ngSubmit",function(){return n.onSubmit()}),a(11,"mat-form-field",6)(12,"mat-label"),r(13,"Tag Name"),o(),C(14,"input",7),s(15,ft,2,0,"mat-error",8),o(),a(16,"div",9),s(17,Ct,2,0,"button",10),a(18,"button",11),r(19),o()()()()(),a(20,"mat-card")(21,"mat-card-header")(22,"mat-card-title"),r(23,"Tags"),o()(),a(24,"mat-card-content")(25,"table",12),h(26,13),s(27,_t,2,0,"th",14)(28,Tt,2,1,"td",15),b(),h(29,16),s(30,ht,2,0,"th",14)(31,xt,3,2,"td",15),b(),s(32,St,1,0,"tr",17)(33,vt,1,0,"tr",18)(34,wt,3,0,"tr",19),o()()()()()),i&2&&(l(8),M(n.isEditMode?"Edit Tag":"Add New Tag"),l(6),m("formControl",n.tagNameControl),l(),m("ngIf",n.tagNameControl.hasError("required")),l(2),m("ngIf",n.isEditMode),l(),m("disabled",n.tagNameControl.invalid||n.isSubmitting),l(),S(" ",n.isSubmitting?"Saving...":n.isEditMode?"Update":"Create"," "),l(6),m("dataSource",n.tags),l(7),m("matHeaderRowDef",n.displayedColumns),l(),m("matRowDefColumns",n.displayedColumns))},dependencies:[w,v,H,O,N,R,V,P,st,Y,tt,nt,et,Z,ot,it,at,rt,lt,mt,K,J,z,W,Q,k,y,I,L,D,q,j,A,$,G,U,ct],styles:[".tag-container[_ngcontent-%COMP%]{width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.tag-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:300px 1fr;gap:20px}.tag-form-card[_ngcontent-%COMP%]{position:sticky;top:20px}.full-width[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end;margin-top:16px}.tag-table[_ngcontent-%COMP%]{width:100%}@media (max-width: 767px){.tag-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{ut as TagListComponent};
