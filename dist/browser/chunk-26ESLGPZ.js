import{a as le}from"./chunk-PPW2AVZW.js";import{a as de}from"./chunk-MRIKSRXR.js";import{c as re}from"./chunk-EFAJY4UT.js";import"./chunk-TDINK5PU.js";import{a as ee,b as te}from"./chunk-L2OVOT2R.js";import{b as oe,g as se}from"./chunk-54ULQ5WC.js";import{d as ie,h as ae,i as ne}from"./chunk-PXLRJANG.js";import"./chunk-H5SIC52C.js";import"./chunk-3Z3MOL6J.js";import{a as F,b as N,c as V,f as A,h as W}from"./chunk-QTDDUBQI.js";import{a as Y,b as Z}from"./chunk-SWI6467K.js";import{a as J,d as K}from"./chunk-2D2I2PDG.js";import{b as H,i as G}from"./chunk-PTRNPYW6.js";import{a as $}from"./chunk-URY737FD.js";import{g as j,l as q,x as z}from"./chunk-NZ7PJTNX.js";import"./chunk-75BXHIVP.js";import{a as B}from"./chunk-5XSEBNVB.js";import"./chunk-4MJ6IACY.js";import{q as Q,u as X}from"./chunk-FE5XWYP3.js";import"./chunk-GTI6TFUP.js";import{a as P,c as L,d as U}from"./chunk-VSTSZJ55.js";import{Bc as R,Cc as D,Db as M,Fb as b,Fc as k,Gb as d,Kc as O,Rb as a,Sb as p,Ta as o,Tb as T,Ub as y,Wb as _,Xb as x,Yb as h,ac as I,cb as S,cc as E,dc as w,hb as v,ja as c,ob as s,qa as u,ra as g,xb as i,yb as t,zb as C}from"./chunk-KAD4X6AH.js";var ce=r=>["/reservations/edit",r];function pe(r,n){if(r&1&&(i(0,"button",16)(1,"mat-icon",7),a(2,"edit"),t(),a(3," Edit "),t()),r&2){let e=d(2);s("routerLink",I(1,ce,e.reservation._id))}}function ve(r,n){if(r&1&&(i(0,"div",11)(1,"span",12),a(2,"Email:"),t(),i(3,"span"),a(4),t()()),r&2){let e=d(2);o(4),p(e.reservation.customer.email)}}function ue(r,n){if(r&1&&(i(0,"div",11)(1,"span",12),a(2,"Special Requests:"),t(),i(3,"span"),a(4),t()()),r&2){let e=d(2);o(4),p(e.reservation.specialRequests)}}function ge(r,n){if(r&1&&(i(0,"mat-option",32),a(1),t()),r&2){let e=n.$implicit;s("value",e._id),o(),y(" Table ",e.tableNumber," (Capacity: ",e.capacity,") ")}}function fe(r,n){if(r&1){let e=M();i(0,"mat-card")(1,"mat-card-header")(2,"mat-card-title"),a(3,"Manage Reservation"),t()(),i(4,"mat-card-content")(5,"div",17)(6,"div",18)(7,"h3"),a(8,"Update Status"),t(),i(9,"mat-form-field",19)(10,"mat-label"),a(11,"Status"),t(),i(12,"mat-select",20),h("ngModelChange",function(l){u(e);let f=d(2);return x(f.selectedStatus,l)||(f.selectedStatus=l),g(l)}),i(13,"mat-option",21),a(14,"Pending"),t(),i(15,"mat-option",22),a(16,"Confirmed"),t(),i(17,"mat-option",23),a(18,"Seated"),t(),i(19,"mat-option",24),a(20,"Completed"),t(),i(21,"mat-option",25),a(22,"Cancelled"),t(),i(23,"mat-option",26),a(24,"No-show"),t()()(),i(25,"button",27),b("click",function(){u(e);let l=d(2);return g(l.updateStatus())}),a(26," Update Status "),t()(),C(27,"mat-divider",28),i(28,"div",29)(29,"h3"),a(30,"Assign Table"),t(),i(31,"mat-form-field",19)(32,"mat-label"),a(33,"Select Table"),t(),i(34,"mat-select",20),h("ngModelChange",function(l){u(e);let f=d(2);return x(f.selectedTableId,l)||(f.selectedTableId=l),g(l)}),v(35,ge,2,3,"mat-option",30),t()(),i(36,"button",31),b("click",function(){u(e);let l=d(2);return g(l.loadAvailableTables())}),i(37,"mat-icon",7),a(38,"refresh"),t(),a(39," Refresh Tables "),t(),i(40,"button",27),b("click",function(){u(e);let l=d(2);return g(l.assignTable())}),a(41," Assign Table "),t()()()()()}if(r&2){let e=d(2);o(12),_("ngModel",e.selectedStatus),s("disabled",e.isUpdating),o(13),s("disabled",e.selectedStatus===e.reservation.status||e.isUpdating),o(9),_("ngModel",e.selectedTableId),s("disabled",e.isUpdating||!e.availableTables.length),o(),s("ngForOf",e.availableTables),o(),s("disabled",e.isLoading),o(4),s("disabled",!e.selectedTableId||e.isUpdating)}}function be(r,n){if(r&1&&(i(0,"div",2)(1,"div",3)(2,"span",4),a(3,"Reservation Details"),t(),i(4,"div",5)(5,"button",6)(6,"mat-icon",7),a(7,"arrow_back"),t(),a(8," Back to List "),t(),v(9,pe,4,3,"button",8),t()(),i(10,"div",9)(11,"mat-card")(12,"mat-card-header")(13,"mat-card-title"),a(14,"Customer Information"),t()(),i(15,"mat-card-content")(16,"div",10)(17,"div",11)(18,"span",12),a(19,"Name:"),t(),i(20,"span"),a(21),t()(),i(22,"div",11)(23,"span",12),a(24,"Phone:"),t(),i(25,"span"),a(26),t()(),v(27,ve,5,1,"div",13),t()()(),i(28,"mat-card")(29,"mat-card-header")(30,"mat-card-title"),a(31,"Reservation Details"),t()(),i(32,"mat-card-content")(33,"div",10)(34,"div",11)(35,"span",12),a(36,"Date & Time:"),t(),i(37,"span"),a(38),t()(),i(39,"div",11)(40,"span",12),a(41,"Party Size:"),t(),i(42,"span"),a(43),t()(),i(44,"div",11)(45,"span",12),a(46,"Status:"),t(),i(47,"mat-chip",14),a(48),E(49,"titlecase"),t()(),i(50,"div",11)(51,"span",12),a(52,"Table:"),t(),i(53,"span"),a(54),t()(),v(55,ue,5,1,"div",13),t()()(),v(56,fe,42,8,"mat-card",15),t()()),r&2){let e=d();o(9),s("ngIf",e.canManageReservations()),o(12),p(e.reservation.customer.name),o(5),p(e.reservation.customer.phoneNumber),o(),s("ngIf",e.reservation.customer.email),o(11),p(e.formatDateTime(e.reservation.reservationDate)),o(5),T("",e.reservation.partySize," people"),o(4),s("color",e.getStatusColor(e.reservation.status)),o(),p(w(49,11,e.reservation.status)),o(6),p(e.getTableInfo()),o(),s("ngIf",e.reservation.specialRequests),o(),s("ngIf",e.canManageReservations())}}function _e(r,n){r&1&&(i(0,"div",33)(1,"p"),a(2,"Loading reservation details..."),t()())}var me=class r{route=c(P);router=c(L);reservationService=c(le);tableService=c(de);authService=c(B);snackBar=c($);dialog=c(re);reservation=null;isLoading=!0;isUpdating=!1;reservationId="";selectedStatus="";selectedTableId="";availableTables=[];ngOnInit(){this.reservationId=this.route.snapshot.params.id,this.reservationId?this.loadReservation():this.router.navigate(["/reservations"])}loadReservation(){this.isLoading=!0,this.reservationService.getReservationById(this.reservationId).subscribe({next:n=>{this.reservation=n.data.reservation,this.selectedStatus=this.reservation.status,this.reservation.table&&typeof this.reservation.table=="object"&&(this.selectedTableId=this.reservation.table._id),this.isLoading=!1,this.loadAvailableTables()},error:n=>{this.snackBar.open(n.error?.message||"Failed to load reservation","Close",{duration:5e3}),this.isLoading=!1,this.router.navigate(["/reservations"])}})}loadAvailableTables(){if(!this.reservation)return;let n=new Date(this.reservation.reservationDate).toISOString().split("T")[0];this.reservationService.getAvailableTables(n,this.reservation.partySize).subscribe({next:e=>{if(this.availableTables=e.data.availableTables,this.reservation?.table&&typeof this.reservation.table=="object"){let m=this.reservation.table._id;this.availableTables.some(l=>l._id===m)||this.availableTables.push(this.reservation.table)}},error:e=>{this.snackBar.open(e.error?.message||"Failed to load available tables","Close",{duration:5e3})}})}updateStatus(){if(!this.reservation||this.selectedStatus===this.reservation.status)return;this.isUpdating=!0;let n={status:this.selectedStatus};this.reservationService.updateStatus(this.reservationId,n).subscribe({next:e=>{this.reservation=e.data.reservation,this.snackBar.open("Reservation status updated successfully","Close",{duration:3e3}),this.isUpdating=!1},error:e=>{this.snackBar.open(e.error?.message||"Failed to update status","Close",{duration:5e3}),this.isUpdating=!1}})}assignTable(){!this.reservation||!this.selectedTableId||(this.isUpdating=!0,this.reservationService.assignTable(this.reservationId,{tableId:this.selectedTableId}).subscribe({next:n=>{this.reservation=n.data.reservation,this.snackBar.open("Table assigned successfully","Close",{duration:3e3}),this.isUpdating=!1},error:n=>{this.snackBar.open(n.error?.message||"Failed to assign table","Close",{duration:5e3}),this.isUpdating=!1}}))}formatDateTime(n){return new Date(n).toLocaleString()}getTableInfo(){return this.reservation?.table?typeof this.reservation.table=="string"?"Assigned":`Table ${this.reservation.table.tableNumber} (Capacity: ${this.reservation.table.capacity})`:"Not assigned"}getStatusColor(n){switch(n){case"confirmed":return"primary";case"seated":return"accent";case"completed":return"";case"pending":return"warn";case"cancelled":return"";case"no-show":return"";default:return""}}canManageReservations(){let n=this.authService.getCurrentUser();return n?.role==="manager"||n?.role==="staff"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["app-reservation-detail"]],decls:2,vars:2,consts:[["class","container",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"container"],[1,"header-actions"],[1,"top-label"],[1,"action-buttons"],["mat-button","","color","primary","routerLink","/reservations"],[1,"material-symbols-outlined"],["mat-raised-button","","color","accent",3,"routerLink",4,"ngIf"],[1,"detail-grid"],[1,"info-container"],[1,"info-row"],[1,"label"],["class","info-row",4,"ngIf"],["selected","",3,"color"],[4,"ngIf"],["mat-raised-button","","color","accent",3,"routerLink"],[1,"management-section"],[1,"status-update"],["appearance","outline",1,"full-width"],[3,"ngModelChange","ngModel","disabled"],["value","pending"],["value","confirmed"],["value","seated"],["value","completed"],["value","cancelled"],["value","no-show"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"section-divider"],[1,"table-assignment"],[3,"value",4,"ngFor","ngForOf"],["mat-button","","color","primary",3,"click","disabled"],[3,"value"],[1,"loading-container"]],template:function(e,m){e&1&&v(0,be,57,13,"div",0)(1,_e,3,0,"div",1),e&2&&(s("ngIf",m.reservation),o(),s("ngIf",m.isLoading))},dependencies:[O,R,D,k,U,W,F,V,A,N,X,Q,Z,Y,se,oe,te,ee,ne,G,H,ae,ie,K,J,z,j,q],styles:[".container[_ngcontent-%COMP%]{width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:10px}.detail-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(400px,1fr));gap:20px}.info-container[_ngcontent-%COMP%]{padding:16px 0}.info-row[_ngcontent-%COMP%]{margin-bottom:16px;display:flex;align-items:center}.label[_ngcontent-%COMP%]{font-weight:500;width:150px}.management-section[_ngcontent-%COMP%]{padding:16px 0}.status-update[_ngcontent-%COMP%], .table-assignment[_ngcontent-%COMP%]{margin-bottom:24px}.section-divider[_ngcontent-%COMP%]{margin:24px 0}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:40px}@media (max-width: 767px){.header-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.action-buttons[_ngcontent-%COMP%]{margin-top:10px;flex-wrap:wrap}}"]})};export{me as ReservationDetailComponent};
