import{a as W}from"./chunk-GSDETIKM.js";import{a as X}from"./chunk-ZTY662S3.js";import{d as J,h as K,i as Q}from"./chunk-KUJCRXF6.js";import"./chunk-MPZJ55NE.js";import"./chunk-4NNSIX2F.js";import{a as F,c as E,h as I}from"./chunk-X4H6S6WA.js";import{a as $,b as z}from"./chunk-FNZWV5VH.js";import{a as T,c as j,d as q}from"./chunk-SG7MWKE6.js";import{b as P,c as V,i as R}from"./chunk-TFWZGPIA.js";import{a as H}from"./chunk-MXW2SQ2E.js";import{b as _,d as x,g as N,h as k,m as B,n as O,p as D,s as w,x as G,z as L}from"./chunk-CG6HKZKU.js";import"./chunk-YE4XPGXQ.js";import"./chunk-4MJ6IACY.js";import{q as A,u as U}from"./chunk-QRFS6CQK.js";import"./chunk-24M76UXH.js";import{a as v,c as M,d as S}from"./chunk-A2KXSCJD.js";import{Bc as b,Cc as h,Fb as f,Kc as C,Rb as i,Sb as y,Ta as n,Tb as u,cb as g,hb as c,ja as l,ob as d,xb as o,yb as t,zb as p}from"./chunk-Q5RHU532.js";function Z(m,r){m&1&&(o(0,"mat-error"),i(1,"Name is required"),t())}function ee(m,r){if(m&1&&(o(0,"mat-option",16),i(1),t()),m&2){let e=r.$implicit;d("value",e._id),n(),y(e.name)}}var Y=class m{fb=l(G);route=l(v);router=l(M);categoryService=l(X);menuService=l(W);snackBar=l(H);categoryForm;isEditMode=!1;isSubmitting=!1;categoryId="";menus=[];ngOnInit(){this.initForm(),this.loadMenus(),this.categoryId=this.route.snapshot.params.id,this.isEditMode=!!this.categoryId,this.isEditMode&&this.loadCategoryData()}initForm(){this.categoryForm=this.fb.group({name:["",x.required],description:[""],order:[0],menus:[[]]})}loadMenus(){this.menuService.getMenus().subscribe({next:r=>{this.menus=r.data.menus},error:r=>{this.snackBar.open(r.error?.message||"Failed to load menus","Close",{duration:5e3})}})}loadCategoryData(){this.categoryService.getCategoryById(this.categoryId).subscribe({next:r=>{let e=r.data.category,a=e.menus.map(s=>typeof s=="string"?s:s._id);this.categoryForm.patchValue({name:e.name,description:e.description||"",order:e.order,menus:a})},error:r=>{this.snackBar.open(r.error?.message||"Failed to load category","Close",{duration:5e3}),this.router.navigate(["/dashboard/categories"])}})}onSubmit(){if(this.categoryForm.invalid)return;this.isSubmitting=!0;let r=this.categoryForm.value;this.isEditMode?this.categoryService.updateCategory(this.categoryId,r).subscribe({next:()=>{this.snackBar.open("Category updated successfully","Close",{duration:3e3}),this.router.navigate(["/dashboard/categories"])},error:e=>{this.isSubmitting=!1,this.snackBar.open(e.error?.message||"Failed to update category","Close",{duration:5e3})}}):this.categoryService.createCategory(r).subscribe({next:()=>{this.snackBar.open("Category created successfully","Close",{duration:3e3}),this.router.navigate(["/dashboard/categories"])},error:e=>{this.isSubmitting=!1,this.snackBar.open(e.error?.message||"Failed to create category","Close",{duration:5e3})}})}static \u0275fac=function(e){return new(e||m)};static \u0275cmp=g({type:m,selectors:[["app-category-form"]],decls:34,vars:6,consts:[[1,"container"],[1,"header-actions"],[1,"top-label"],["mat-button","","color","primary","routerLink","/dashboard/categories"],[1,"material-symbols-outlined"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Enter category name"],[4,"ngIf"],["matInput","","formControlName","description","placeholder","Enter category description","rows","3"],["matInput","","formControlName","order","type","number","placeholder","Enter display order"],["formControlName","menus","multiple",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-actions"],["mat-button","","type","button","routerLink","/dashboard/categories"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"]],template:function(e,a){if(e&1&&(o(0,"div",0)(1,"div",1)(2,"span",2),i(3),t(),o(4,"button",3)(5,"mat-icon",4),i(6,"arrow_back"),t(),i(7," Back to List "),t()(),o(8,"mat-card")(9,"mat-card-content")(10,"form",5),f("ngSubmit",function(){return a.onSubmit()}),o(11,"mat-form-field",6)(12,"mat-label"),i(13,"Category Name"),t(),p(14,"input",7),c(15,Z,2,0,"mat-error",8),t(),o(16,"mat-form-field",6)(17,"mat-label"),i(18,"Description"),t(),p(19,"textarea",9),t(),o(20,"mat-form-field",6)(21,"mat-label"),i(22,"Order"),t(),p(23,"input",10),t(),o(24,"mat-form-field",6)(25,"mat-label"),i(26,"Menus"),t(),o(27,"mat-select",11),c(28,ee,2,2,"mat-option",12),t()(),o(29,"div",13)(30,"button",14),i(31,"Cancel"),t(),o(32,"button",15),i(33),t()()()()()()),e&2){let s;n(3),u("",a.isEditMode?"Edit":"Create"," Category"),n(7),d("formGroup",a.categoryForm),n(5),d("ngIf",(s=a.categoryForm.get("name"))==null?null:s.hasError("required")),n(13),d("ngForOf",a.menus),n(4),d("disabled",a.categoryForm.invalid||a.isSubmitting),n(),u(" ",a.isSubmitting?"Saving...":a.isEditMode?"Update":"Create"," ")}},dependencies:[C,b,h,L,B,_,O,N,k,D,w,S,T,R,P,V,q,j,U,A,Q,K,J,I,F,E,z,$],styles:[".container[_ngcontent-%COMP%]{width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end;margin-top:20px}"]})};export{Y as CategoryFormComponent};
