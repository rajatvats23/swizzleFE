import{a as kt}from"./chunk-CKEYBX22.js";import{a as Dt}from"./chunk-3LM7EGWX.js";import{a as It}from"./chunk-KYWTCKL5.js";import{a as St,b as Et}from"./chunk-2UETUZ57.js";import{a as Ft}from"./chunk-7NFB522G.js";import"./chunk-F5X5MWHG.js";import{a as lt,b as mt}from"./chunk-AE3M3K2R.js";import{c as Mt}from"./chunk-EFAJY4UT.js";import{b as Tt,d as Lt,g as wt}from"./chunk-54ULQ5WC.js";import"./chunk-2OJIEFOL.js";import{a as st,b as ut,c as ft,d as gt,e as _t,f as Ct,g as xt,h as ht,i as Pt,j as yt,k as vt,l as bt}from"./chunk-UAFRLOKJ.js";import{d as ct,h as dt,i as pt}from"./chunk-PXLRJANG.js";import"./chunk-H5SIC52C.js";import"./chunk-3Z3MOL6J.js";import{a as N,c as $,h as R}from"./chunk-QTDDUBQI.js";import{a as ot,b as rt}from"./chunk-SWI6467K.js";import{a as X,c as Y,d as Z}from"./chunk-2D2I2PDG.js";import{b as K,f as Q,i as W}from"./chunk-PTRNPYW6.js";import{a as at}from"./chunk-URY737FD.js";import{b as A,g as B,h as V,m as H,n as j,p as G,s as U,u as z,w as q,y as J}from"./chunk-NZ7PJTNX.js";import"./chunk-75BXHIVP.js";import{a as O}from"./chunk-NQCP3IVX.js";import"./chunk-LK7ZGARP.js";import{n as tt,o as et,q as it,u as nt}from"./chunk-FE5XWYP3.js";import"./chunk-GTI6TFUP.js";import{d as k}from"./chunk-VSTSZJ55.js";import{Ab as s,Bb as u,Bc as w,Cc as F,Db as y,Fb as _,Gb as d,Jc as D,Kc as I,Ra as M,Rb as r,Sb as C,Ta as a,Tb as v,ac as b,cb as S,cc as T,dc as L,hb as c,ja as p,nb as E,ob as l,qa as h,ra as P,xb as o,yb as n,zb as f}from"./chunk-KAD4X6AH.js";var $t=t=>["/dashboard/products",t],Rt=t=>["/dashboard/products/edit",t];function At(t,e){t&1&&(o(0,"button",32)(1,"mat-icon",33),r(2,"add"),n(),r(3," Add Product "),n())}function Bt(t,e){if(t&1&&(o(0,"mat-option",34),r(1),n()),t&2){let i=e.$implicit;l("value",i._id),a(),v(" ",i.name," ")}}function Vt(t,e){if(t&1&&(o(0,"mat-option",34),r(1),n()),t&2){let i=e.$implicit;l("value",i._id),a(),v(" ",i.name," ")}}function Ht(t,e){t&1&&(o(0,"th",35),r(1,"Image"),n())}function jt(t,e){if(t&1&&f(0,"img",39),t&2){let i=d().$implicit;l("src",i.imageUrl,M)}}function Gt(t,e){t&1&&(o(0,"div",40)(1,"mat-icon",33),r(2,"image_not_supported"),n()())}function Ut(t,e){if(t&1&&(o(0,"td",36),c(1,jt,1,1,"img",37)(2,Gt,3,0,"div",38),n()),t&2){let i=e.$implicit;a(),l("ngIf",i.imageUrl),a(),l("ngIf",!i.imageUrl)}}function zt(t,e){t&1&&(o(0,"th",35),r(1,"Name"),n())}function qt(t,e){if(t&1&&(o(0,"td",36),r(1),n()),t&2){let i=e.$implicit;a(),C(i.name)}}function Jt(t,e){t&1&&(o(0,"th",35),r(1,"Price"),n())}function Kt(t,e){if(t&1&&(o(0,"td",36),r(1),T(2,"currency"),n()),t&2){let i=e.$implicit;a(),C(L(2,1,i.price))}}function Qt(t,e){t&1&&(o(0,"th",35),r(1,"Category"),n())}function Wt(t,e){if(t&1&&(o(0,"td",36),r(1),n()),t&2){let i=e.$implicit;a(),C((i.category==null?null:i.category.name)||"N/A")}}function Xt(t,e){t&1&&(o(0,"th",35),r(1,"Tags"),n())}function Yt(t,e){if(t&1&&(o(0,"mat-chip"),r(1),n()),t&2){let i=e.$implicit;a(),C(i.name)}}function Zt(t,e){if(t&1&&(o(0,"mat-chip-set"),c(1,Yt,2,1,"mat-chip",42),n()),t&2){let i=d().$implicit;a(),l("ngForOf",i.tags)}}function te(t,e){t&1&&(o(0,"span"),r(1,"None"),n())}function ee(t,e){if(t&1&&(o(0,"td",36),c(1,Zt,2,1,"mat-chip-set",41)(2,te,2,0,"span",41),n()),t&2){let i=e.$implicit;a(),l("ngIf",i.tags==null?null:i.tags.length),a(),l("ngIf",!(i.tags!=null&&i.tags.length))}}function ie(t,e){t&1&&(o(0,"th",35),r(1,"Available"),n())}function ne(t,e){if(t&1){let i=y();o(0,"td",36)(1,"mat-slide-toggle",43),_("change",function(g){let x=h(i).$implicit,Nt=d();return P(Nt.toggleAvailability(x,g.checked))}),n()()}if(t&2){let i=e.$implicit,m=d();a(),l("checked",i.isAvailable)("disabled",!m.canManageProducts())}}function oe(t,e){t&1&&(o(0,"th",35),r(1,"Actions"),n())}function re(t,e){if(t&1&&(o(0,"a",47)(1,"mat-icon",33),r(2,"edit"),n()()),t&2){let i=d().$implicit;l("routerLink",b(1,Rt,i._id))}}function ae(t,e){if(t&1){let i=y();o(0,"button",48),_("click",function(){h(i);let g=d().$implicit,x=d();return P(x.confirmDelete(g))}),o(1,"mat-icon",33),r(2,"delete"),n()()}}function le(t,e){if(t&1&&(o(0,"td",36)(1,"a",44)(2,"mat-icon",33),r(3,"visibility"),n()(),c(4,re,3,3,"a",45)(5,ae,3,0,"button",46),n()),t&2){let i=e.$implicit,m=d();a(),l("routerLink",b(3,$t,i._id)),a(3),l("ngIf",m.canManageProducts()),a(),l("ngIf",m.canManageProducts())}}function me(t,e){t&1&&f(0,"tr",49)}function ce(t,e){t&1&&f(0,"tr",50)}function de(t,e){if(t&1&&(o(0,"tr",51)(1,"td",52),r(2," No products found "),n()()),t&2){let i=d();a(),E("colspan",i.displayedColumns.length)}}var Ot=class t{fb=p(q);productService=p(kt);categoryService=p(Dt);tagService=p(It);authService=p(O);snackBar=p(at);dialog=p(Mt);products=[];categories=[];tags=[];displayedColumns=["image","name","price","category","tags","availability","actions"];isLoading=!1;filterForm=this.fb.group({search:[""],category:[""],tag:[""],minPrice:[null],maxPrice:[null]});ngOnInit(){this.loadProducts(),this.loadCategories(),this.loadTags()}loadProducts(e={}){this.isLoading=!0,this.productService.getProducts(e).subscribe({next:i=>{this.products=i.data.products,this.isLoading=!1},error:i=>{console.error("Error loading products:",i),this.snackBar.open(i.error?.message||"Failed to load products","Close",{duration:5e3}),this.isLoading=!1}})}loadCategories(){this.categoryService.getCategories().subscribe({next:e=>{this.categories=e.data.categories},error:e=>{console.error("Error loading categories:",e)}})}loadTags(){this.tagService.getTags().subscribe({next:e=>{this.tags=e.data.tags},error:e=>{console.error("Error loading tags:",e)}})}applyFilters(){let e={search:this.filterForm.value.search,category:this.filterForm.value.category,tag:this.filterForm.value.tag,minPrice:this.filterForm.value.minPrice,maxPrice:this.filterForm.value.maxPrice};Object.keys(e).forEach(i=>{(e[i]===void 0||e[i]===null||e[i]==="")&&delete e[i]}),this.loadProducts(e)}resetFilters(){this.filterForm.reset({search:"",category:"",tag:"",minPrice:null,maxPrice:null}),this.loadProducts()}toggleAvailability(e,i){this.productService.updateProduct(e._id,{isAvailable:i}).subscribe({next:()=>{e.isAvailable=i,this.snackBar.open(`Product ${i?"enabled":"disabled"} successfully`,"Close",{duration:3e3})},error:m=>{e.isAvailable=!i,this.snackBar.open(m.error?.message||"Failed to update product","Close",{duration:5e3})}})}confirmDelete(e){this.dialog.open(Ft,{data:{title:"Delete Product",message:`Are you sure you want to delete "${e.name}"?`,confirmText:"Delete",cancelText:"Cancel"}}).afterClosed().subscribe(m=>{m&&this.deleteProduct(e._id)})}deleteProduct(e){this.productService.deleteProduct(e).subscribe({next:()=>{this.snackBar.open("Product deleted successfully","Close",{duration:3e3}),this.loadProducts()},error:i=>{this.snackBar.open(i.error?.message||"Error deleting product","Close",{duration:5e3})}})}canManageProducts(){return this.authService.getCurrentUser()?.role==="manager"}static \u0275fac=function(i){return new(i||t)};static \u0275cmp=S({type:t,selectors:[["app-product-list"]],decls:67,vars:7,consts:[[1,"product-container"],[1,"header-actions"],[1,"header-title"],["mat-raised-button","","color","primary","routerLink","/dashboard/products/create",4,"ngIf"],[1,"filter-card"],[1,"filter-form",3,"formGroup"],["appearance","outline",1,"filter-field"],["matInput","","formControlName","search","placeholder","Search products..."],["matSuffix","",1,"material-symbols-outlined"],["formControlName","category"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","tag"],[1,"price-range"],["matInput","","type","number","formControlName","minPrice","min","0"],["matInput","","type","number","formControlName","maxPrice","min","0"],[1,"filter-actions"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","button",3,"click"],["mat-table","",1,"product-table",3,"dataSource"],["matColumnDef","image"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","price"],["matColumnDef","category"],["matColumnDef","tags"],["matColumnDef","availability"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-raised-button","","color","primary","routerLink","/dashboard/products/create"],[1,"material-symbols-outlined"],[3,"value"],["mat-header-cell",""],["mat-cell",""],["alt","Product image","class","product-image",3,"src",4,"ngIf"],["class","no-image",4,"ngIf"],["alt","Product image",1,"product-image",3,"src"],[1,"no-image"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"change","checked","disabled"],["mat-icon-button","","color","primary","matTooltip","View Details",3,"routerLink"],["mat-icon-button","","color","accent","matTooltip","Edit",3,"routerLink",4,"ngIf"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click",4,"ngIf"],["mat-icon-button","","color","accent","matTooltip","Edit",3,"routerLink"],["mat-icon-button","","color","warn","matTooltip","Delete",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],[1,"mat-cell",2,"text-align","center","padding","16px"]],template:function(i,m){i&1&&(o(0,"div",0)(1,"div",1)(2,"span",2),r(3,"Product Management"),n(),c(4,At,4,0,"button",3),n(),o(5,"mat-card",4)(6,"mat-card-content")(7,"form",5)(8,"mat-form-field",6)(9,"mat-label"),r(10,"Search"),n(),f(11,"input",7),o(12,"mat-icon",8),r(13,"search"),n()(),o(14,"mat-form-field",6)(15,"mat-label"),r(16,"Category"),n(),o(17,"mat-select",9)(18,"mat-option",10),r(19,"All Categories"),n(),c(20,Bt,2,2,"mat-option",11),n()(),o(21,"mat-form-field",6)(22,"mat-label"),r(23,"Tag"),n(),o(24,"mat-select",12)(25,"mat-option",10),r(26,"All Tags"),n(),c(27,Vt,2,2,"mat-option",11),n()(),o(28,"div",13)(29,"mat-form-field",6)(30,"mat-label"),r(31,"Min Price"),n(),f(32,"input",14),n(),o(33,"mat-form-field",6)(34,"mat-label"),r(35,"Max Price"),n(),f(36,"input",15),n()(),o(37,"div",16)(38,"button",17),_("click",function(){return m.resetFilters()}),r(39,"Reset"),n(),o(40,"button",18),_("click",function(){return m.applyFilters()}),r(41,"Apply Filters"),n()()()()(),o(42,"table",19),s(43,20),c(44,Ht,2,0,"th",21)(45,Ut,3,2,"td",22),u(),s(46,23),c(47,zt,2,0,"th",21)(48,qt,2,1,"td",22),u(),s(49,24),c(50,Jt,2,0,"th",21)(51,Kt,3,3,"td",22),u(),s(52,25),c(53,Qt,2,0,"th",21)(54,Wt,2,1,"td",22),u(),s(55,26),c(56,Xt,2,0,"th",21)(57,ee,3,2,"td",22),u(),s(58,27),c(59,ie,2,0,"th",21)(60,ne,2,2,"td",22),u(),s(61,28),c(62,oe,2,0,"th",21)(63,le,6,5,"td",22),u(),c(64,me,1,0,"tr",29)(65,ce,1,0,"tr",30)(66,de,3,1,"tr",31),n()()),i&2&&(a(4),l("ngIf",m.canManageProducts()),a(3),l("formGroup",m.filterForm),a(13),l("ngForOf",m.categories),a(7),l("ngForOf",m.tags),a(15),l("dataSource",m.products),a(22),l("matHeaderRowDef",m.displayedColumns),a(),l("matRowDefColumns",m.displayedColumns))},dependencies:[I,w,F,D,k,J,H,A,j,B,V,z,G,U,bt,st,ft,xt,gt,ut,ht,_t,Ct,Pt,yt,vt,nt,it,et,tt,rt,ot,R,N,$,X,W,K,Q,Z,Y,pt,dt,ct,Et,St,mt,lt,wt,Tt,Lt],styles:[".product-container[_ngcontent-%COMP%]{width:100%}.header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.filter-card[_ngcontent-%COMP%]{margin-bottom:20px}.filter-form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px;align-items:center}.filter-field[_ngcontent-%COMP%]{flex:1;min-width:200px}.price-range[_ngcontent-%COMP%]{display:flex;gap:16px;flex:2;min-width:300px}.filter-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-left:auto}.product-table[_ngcontent-%COMP%]{width:100%}.product-image[_ngcontent-%COMP%]{width:60px;height:60px;object-fit:cover;border-radius:4px}.no-image[_ngcontent-%COMP%]{width:60px;height:60px;display:flex;align-items:center;justify-content:center;background-color:#f5f5f5;border-radius:4px}@media (max-width: 767px){.filter-form[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.filter-field[_ngcontent-%COMP%], .price-range[_ngcontent-%COMP%]{min-width:100%}.price-range[_ngcontent-%COMP%]{flex-direction:column;gap:0}.filter-actions[_ngcontent-%COMP%]{margin-left:0;justify-content:flex-end}}"]})};export{Ot as ProductListComponent};
